<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ä½™èˆå“¡å·¥æœå‹™ç³»çµ± - å®Œæ•´ç‰ˆå«å¾Œå°ç®¡ç†">
    <title>ä½™èˆå“¡å·¥æœå‹™ç³»çµ±</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¢</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .system-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: white;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-weight: bold;
            display: none;
        }

        .alert.success {
            background: rgba(40, 167, 69, 0.9);
            color: white;
        }

        .alert.error {
            background: rgba(220, 53, 69, 0.9);
            color: white;
        }

        .alert.warning {
            background: rgba(255, 193, 7, 0.9);
            color: #333;
        }

        .alert.info {
            background: rgba(23, 162, 184, 0.9);
            color: white;
        }

        .alert.show {
            display: block;
        }

        .login-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .login-form {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .login-form select {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            min-width: 250px;
        }

        .login-form button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.2s ease;
        }

        .login-form button:hover {
            transform: translateY(-2px);
        }

        .admin-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            margin-left: 10px;
        }

        .user-info {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none;
        }

        .user-info.active {
            display: block;
        }

        .user-info h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .user-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .user-detail {
            color: #666;
        }

        .user-detail strong {
            color: #333;
        }

        .leave-balance {
            background: linear-gradient(135deg, #36d1dc 0%, #5b86e5 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .leave-balance h4 {
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .balance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .balance-item {
            text-align: center;
        }

        .balance-item .number {
            font-size: 1.8rem;
            font-weight: bold;
            display: block;
        }

        .balance-item .label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .service-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: center;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .service-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .service-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .service-card p {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .service-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .service-btn:hover {
            transform: translateY(-2px);
        }

        .service-btn.disabled {
            background: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .service-btn.disabled:hover {
            transform: none;
        }

        /* è¡¨å–®æ¨£å¼ */
        .form-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none;
        }

        .form-container.active {
            display: block;
        }

        .form-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .form-header h2 {
            color: #333;
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .form-header p {
            color: #666;
            font-size: 1rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group label.required::after {
            content: " *";
            color: #dc3545;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .hours-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .hours-error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }

        .form-actions button {
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform 0.2s ease;
            min-width: 120px;
        }

        .form-actions .btn-cancel {
            background: #6c757d;
            color: white;
        }

        .form-actions .btn-submit {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .form-actions button:hover {
            transform: translateY(-2px);
        }

        .form-actions button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .form-actions button:disabled:hover {
            transform: none;
        }

        /* ç®¡ç†å¾Œå°æ¨£å¼ */
        .admin-panel {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .admin-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .admin-controls select,
        .admin-controls input {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .admin-controls button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #333;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .footer {
            text-align: center;
            color: white;
            opacity: 0.7;
            margin-top: 40px;
            padding: 20px;
        }

        .footer small {
            font-size: 0.9rem;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .services-grid {
                grid-template-columns: 1fr;
            }

            .login-form {
                flex-direction: column;
                align-items: stretch;
            }

            .login-form select,
            .login-form button {
                width: 100%;
            }

            .user-details {
                grid-template-columns: 1fr;
            }

            .balance-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .form-actions {
                flex-direction: column;
            }

            .admin-header {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }

            .admin-controls {
                flex-direction: column;
            }

            .data-table {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .balance-grid {
                grid-template-columns: 1fr;
            }

            .service-card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ç³»çµ±æ¨™é¡Œ -->
        <div class="header">
            <h1>ä½™èˆå“¡å·¥æœå‹™ç³»çµ±</h1>
            <p>å®Œæ•´ç‰ˆ - å«æ™‚æ•¸é©—è­‰èˆ‡å¾Œå°ç®¡ç†</p>
        </div>

        <!-- ç³»çµ±è³‡è¨Š -->
        <div class="system-info">
            <small>ğŸŒ å³æ™‚æ™‚æ•¸é©—è­‰ | ğŸ“Š å¾Œå°è³‡æ–™ç®¡ç† | ğŸ“ å®Œæ•´ç”³è«‹æµç¨‹ | ğŸ–¨ï¸ è³‡æ–™æŸ¥è©¢åˆ—å°</small>
        </div>

        <!-- ç³»çµ±æç¤º -->
        <div id="systemAlert" class="alert">
            ç³»çµ±å·²è¼‰å…¥å®Œæˆ
        </div>

        <!-- ç”¨æˆ¶ç™»å…¥å€åŸŸ -->
        <div class="login-section">
            <h3>ğŸ‘¤ é¸æ“‡ç”¨æˆ¶èº«ä»½</h3>
            <div class="login-form">
                <select id="userSelect">
                    <option value="">è«‹é¸æ“‡ç”¨æˆ¶...</option>
                    <option value="A19001">å»–è¿°ç›› (A19001) - è‘£äº‹é•·</option>
                    <option value="A19051">ç‹å½§ç–† (A19051) - ç‡Ÿé‹ç¸½ç›£</option>
                    <option value="A19104">é™³å®¶èˆˆ (A19104) - ç®¡ç†éƒ¨å‰¯ç†</option>
                    <option value="A19132">é»ƒå´‘å¢ƒ (A19132) - å·¥å‹™ä¸»ä»»</option>
                    <option value="A19147">å¾å¿—å±¹ (A19147) - è¡ŒéŠ·æ¥­å‹™ä¸»ä»»</option>
                    <option value="A19107">æ±Ÿå­Ÿåº­ (A19107) - å®¢å‹™çµ„é•·</option>
                    <option value="A19024">è•­ç¶­å® (A19024) - å®¢å‹™çµ„é•·</option>
                    <option value="A19114">å®‹æ·å®‰ (A19114) - é£¯åº—ç®¡å®¶</option>
                    <option value="A19133">é™³ç´…ç§€ (A19133) - é£¯åº—ç®¡å®¶</option>
                    <option value="A19145">æ—å®¶æ¥™ (A19145) - é£¯åº—ç®¡å®¶</option>
                    <option value="A19149">æ¥Šä¸å‹› (A19149) - é£¯åº—ç®¡å®¶</option>
                    <option value="A19152">å¾å¥•ç¿” (A19152) - é£¯åº—ç®¡å®¶</option>
                    <option value="A19140">æŸ¯å®—ç”· (A19140) - å®¢å‹™çµ„é•·</option>
                    <option value="A19016">æç¶­è (A19016) - å®¢æˆ¿éƒ¨å‰¯ç†</option>
                    <option value="A19065">è¨±é‚¦èˆˆ (A19065) - è³‡æ·±æˆ¿å‹™å“¡</option>
                    <option value="A19146">ç‹æ–‡ä¸€ (A19146) - è³‡æ·±æˆ¿å‹™çµ„é•·</option>
                    <option value="A19118">ç¾…ç´¹æ–‡ (A19118) - è³‡æ·±æˆ¿å‹™å“¡</option>
                    <option value="A19136">æ—å¥‡ç·¯ (A19136) - è³‡æ·±æˆ¿å‹™å“¡</option>
                    <option value="A19151">æŸ³ä½³ç’‹ (A19151) - è³‡æ·±æˆ¿å‹™å“¡</option>
                    <option value="A19002">HR (A19002) - ç®¡ç†å“¡</option>
                </select>
                <button onclick="switchUser()">åˆ‡æ›ç”¨æˆ¶</button>
                <button class="admin-btn" onclick="showAdminPanel()">ç®¡ç†å¾Œå°</button>
            </div>
        </div>

        <!-- ç”¨æˆ¶è³‡è¨Šå€åŸŸ -->
        <div id="userInfo" class="user-info">
            <h3>ğŸ‘¤ ç”¨æˆ¶è³‡è¨Š</h3>
            <div class="user-details">
                <div class="user-detail">
                    <strong>å§“åï¼š</strong><span id="userName"></span>
                </div>
                <div class="user-detail">
                    <strong>ç·¨è™Ÿï¼š</strong><span id="userId"></span>
                </div>
                <div class="user-detail">
                    <strong>éƒ¨é–€ï¼š</strong><span id="userDept"></span>
                </div>
                <div class="user-detail">
                    <strong>è·ä½ï¼š</strong><span id="userPosition"></span>
                </div>
                <div class="user-detail">
                    <strong>Emailï¼š</strong><span id="userEmail"></span>
                </div>
                <div class="user-detail">
                    <strong>æ¬Šé™ï¼š</strong><span id="userAuthority"></span>
                </div>
            </div>
            
            <div class="leave-balance">
                <h4>ğŸ“Š å‡æœŸé¤˜é¡</h4>
                <div class="balance-grid">
                    <div class="balance-item">
                        <span class="number" id="annualLeave">0</span>
                        <span class="label">ç‰¹ä¼‘æ™‚æ•¸</span>
                    </div>
                    <div class="balance-item">
                        <span class="number" id="compensatoryLeave">0</span>
                        <span class="label">è£œä¼‘æ™‚æ•¸</span>
                    </div>
                    <div class="balance-item">
                        <span class="number" id="totalLeave">0</span>
                        <span class="label">ç¸½å¯ç”¨æ™‚æ•¸</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- æœå‹™åŠŸèƒ½å€åŸŸ -->
        <div class="services-grid">
            <!-- èª¿ç­ç”³è«‹ -->
            <div class="service-card">
                <div class="service-icon">ğŸ”„</div>
                <h3>èª¿ç­ç”³è«‹</h3>
                <p>ç”³è«‹èª¿æ•´å·¥ä½œç­æ¬¡æˆ–æ›´æ”¹å·¥ä½œæ™‚é–“</p>
                <button class="service-btn" onclick="showForm('schedule')">ç«‹å³ç”³è«‹</button>
            </div>

            <!-- è«‹å‡ç”³è«‹ -->
            <div class="service-card">
                <div class="service-icon">ğŸ–ï¸</div>
                <h3>è«‹å‡ç”³è«‹</h3>
                <p>ç”³è«‹å„é¡å‡æœŸï¼ŒåŒ…å«äº‹å‡ã€ç—…å‡ã€ç‰¹ä¼‘ç­‰</p>
                <button class="service-btn" onclick="showForm('leave')">ç«‹å³ç”³è«‹</button>
            </div>

            <!-- ç‰¹ä¼‘è£œä¼‘ç”³è«‹ -->
            <div class="service-card">
                <div class="service-icon">â±ï¸</div>
                <h3>ç‰¹ä¼‘è£œä¼‘ç”³è«‹</h3>
                <p>ç”³è«‹ç‰¹ä¼‘æˆ–è£œä¼‘ï¼Œç³»çµ±æœƒå³æ™‚æª¢æŸ¥å¯ç”¨æ™‚æ•¸</p>
                <button class="service-btn" onclick="showForm('vacation')">ç«‹å³ç”³è«‹</button>
            </div>

            <!-- æˆ¿å‹™çé‡‘ç”³è«‹ -->
            <div class="service-card">
                <div class="service-icon">ğŸ </div>
                <h3>æˆ¿å‹™çé‡‘ç”³è«‹</h3>
                <p>æˆ¿å‹™äººå“¡ç¸¾æ•ˆã€æ¸…æ½”å’Œæœå‹™çé‡‘</p>
                <button class="service-btn" onclick="showForm('bonus')">ç«‹å³ç”³è«‹</button>
            </div>

            <!-- åŠ ç­ç”³è«‹ -->
            <div class="service-card">
                <div class="service-icon">â°</div>
                <h3>åŠ ç­ç”³è«‹</h3>
                <p>ç”³è«‹åŠ ç­æ™‚æ•¸ï¼Œç³»çµ±å°‡è‡ªå‹•è¨ˆç®—åŠ ç­è²»</p>
                <button class="service-btn" onclick="showForm('overtime')">ç«‹å³ç”³è«‹</button>
            </div>

            <!-- è£œæ‰“å¡ç”³è«‹ -->
            <div class="service-card">
                <div class="service-icon">ğŸ•</div>
                <h3>è£œæ‰“å¡ç”³è«‹</h3>
                <p>å¿˜è¨˜æ‰“å¡æ™‚å¯ä»¥ç”³è«‹è£œç™»å‡ºå‹¤è¨˜éŒ„</p>
                <button class="service-btn" onclick="showForm('clock')">ç«‹å³ç”³è«‹</button>
            </div>
        </div>

        <!-- ç‰¹ä¼‘è£œä¼‘ç”³è«‹è¡¨å–® -->
        <div id="vacationForm" class="form-container">
            <div class="form-header">
                <h2>ç‰¹ä¼‘è£œä¼‘ç”³è«‹è¡¨å–®</h2>
                <p>ç³»çµ±æœƒå³æ™‚æª¢æŸ¥æ‚¨çš„å¯ç”¨æ™‚æ•¸</p>
            </div>
            <form id="vacationApplicationForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="vacation_type" class="required">ç”³è«‹é¡å‹</label>
                        <select id="vacation_type" name="vacationType" required onchange="updateAvailableHours()">
                            <option value="">è«‹é¸æ“‡...</option>
                            <option value="ç‰¹ä¼‘">ç‰¹ä¼‘</option>
                            <option value="è£œä¼‘">è£œä¼‘</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vacation_availableHours">å¯ç”¨æ™‚æ•¸</label>
                        <input type="text" id="vacation_availableHours" readonly style="background: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label for="vacation_startDateTime" class="required">èµ·å§‹æ—¥æœŸèˆ‡æ™‚é–“</label>
                        <input type="datetime-local" id="vacation_startDateTime" name="startDateTime" required onchange="calculateRequestedHours()">
                    </div>
                    <div class="form-group">
                        <label for="vacation_endDateTime" class="required">çµæŸæ—¥æœŸèˆ‡æ™‚é–“</label>
                        <input type="datetime-local" id="vacation_endDateTime" name="endDateTime" required onchange="calculateRequestedHours()">
                    </div>
                    <div class="form-group">
                        <label for="vacation_requestedHours">ç”³è«‹æ™‚æ•¸</label>
                        <input type="number" id="vacation_requestedHours" name="requestedHours" step="0.5" min="0" readonly style="background: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label for="vacation_remainingHours">ç”³è«‹å¾Œå‰©é¤˜æ™‚æ•¸</label>
                        <input type="text" id="vacation_remainingHours" readonly style="background: #f8f9fa;">
                    </div>
                    <div class="form-group full-width">
                        <label for="vacation_reason" class="required">ç”³è«‹äº‹ç”±</label>
                        <textarea id="vacation_reason" name="reason" required placeholder="è«‹è©³ç´°èªªæ˜ç”³è«‹åŸå› "></textarea>
                    </div>
                    <div class="form-group">
                        <label for="vacation_deputy" class="required">è·å‹™ä»£ç†äºº</label>
                        <select id="vacation_deputy" name="deputy" required>
                            <option value="">è«‹é¸æ“‡...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vacation_applicantName" class="required">ç”³è«‹äººå§“å</label>
                        <input type="text" id="vacation_applicantName" name="applicantName" required readonly>
                    </div>
                    <div class="form-group">
                        <label for="vacation_applicantId" class="required">ç”³è«‹äººç·¨è™Ÿ</label>
                        <input type="text" id="vacation_applicantId" name="applicantId" required readonly>
                    </div>
                    <div class="form-group">
                        <label for="vacation_applicantDept" class="required">ç”³è«‹äººéƒ¨é–€</label>
                        <input type="text" id="vacation_applicantDept" name="applicantDept" required readonly>
                    </div>
                    <div class="form-group">
                        <label for="vacation_applicantPosition" class="required">ç”³è«‹äººè·ä½</label>
                        <input type="text" id="vacation_applicantPosition" name="applicantPosition" required readonly>
                    </div>
                </div>
                <div id="vacation_hoursWarning" class="hours-warning" style="display: none;"></div>
                <div id="vacation_hoursError" class="hours-error" style="display: none;"></div>
                <div class="form-actions">
                    <button type="button" class="btn-cancel" onclick="hideForm()">å–æ¶ˆ</button>
                    <button type="submit" class="btn-submit" id="vacation_submitBtn">æäº¤ç”³è«‹</button>
                </div>
            </form>
        </div>

        <!-- å…¶ä»–è¡¨å–®çœç•¥ï¼Œçµæ§‹é¡ä¼¼... -->
        <!-- é€™è£¡æœƒåŒ…å«èª¿ç­ã€è«‹å‡ã€æˆ¿å‹™çé‡‘ã€åŠ ç­ã€è£œæ‰“å¡ç­‰è¡¨å–® -->

        <!-- ç®¡ç†å¾Œå° -->
        <div id="adminPanel" class="admin-panel">
            <div class="admin-header">
                <h2>ğŸ“Š ç®¡ç†å¾Œå°</h2>
                <button onclick="hideAdminPanel()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">é—œé–‰</button>
            </div>
            
            <div class="admin-controls">
                <select id="admin_filterType">
                    <option value="">æ‰€æœ‰ç”³è«‹é¡å‹</option>
                    <option value="schedule">èª¿ç­ç”³è«‹</option>
                    <option value="leave">è«‹å‡ç”³è«‹</option>
                    <option value="vacation">ç‰¹ä¼‘è£œä¼‘ç”³è«‹</option>
                    <option value="bonus">æˆ¿å‹™çé‡‘ç”³è«‹</option>
                    <option value="overtime">åŠ ç­ç”³è«‹</option>
                    <option value="clock">è£œæ‰“å¡ç”³è«‹</option>
                </select>
                
                <select id="admin_filterStatus">
                    <option value="">æ‰€æœ‰ç‹€æ…‹</option>
                    <option value="å¾…å¯©æ ¸">å¾…å¯©æ ¸</option>
                    <option value="å·²æ ¸å‡†">å·²æ ¸å‡†</option>
                    <option value="å·²æ‹’çµ•">å·²æ‹’çµ•</option>
                </select>
                
                <input type="date" id="admin_filterDate" placeholder="ç¯©é¸æ—¥æœŸ">
                
                <button onclick="filterApplications()">ç¯©é¸</button>
                <button onclick="exportData()">åŒ¯å‡ºè³‡æ–™</button>
                <button onclick="printData()">åˆ—å°</button>
                <button onclick="refreshData()">é‡æ–°æ•´ç†</button>
            </div>
            
            <div id="admin_dataContainer">
                <table class="data-table" id="admin_dataTable">
                    <thead>
                        <tr>
                            <th>ç”³è«‹ç·¨è™Ÿ</th>
                            <th>ç”³è«‹é¡å‹</th>
                            <th>ç”³è«‹äºº</th>
                            <th>ç”³è«‹æ™‚é–“</th>
                            <th>ç‹€æ…‹</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="admin_dataBody">
                        <!-- è³‡æ–™æœƒå‹•æ…‹è¼‰å…¥ -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- é è…³ -->
        <div class="footer">
            <small>Â© 2025 ä½™èˆå“¡å·¥æœå‹™ç³»çµ± | å®Œæ•´ç‰ˆ v5.0 | å«æ™‚æ•¸é©—è­‰èˆ‡å¾Œå°ç®¡ç†</small>
        </div>
    </div>

    <script>
        // å…§å»º API URL - éƒ¨ç½²å¾Œç«¯å¾Œè«‹æ›´æ–°æ­¤ URL
        const API_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';

        // å®Œæ•´å“¡å·¥è³‡æ–™
        const EMPLOYEES = {
            'A19001': { name: 'å»–è¿°ç››', department: 'è‘£äº‹é•·å®¤', position: 'è‘£äº‹é•·', email: 'ssalex.liaw@gmail.com', annualLeave: 0, compensatoryLeave: 0, authority: 'ä¸»ç®¡' },
            'A19051': { name: 'ç‹å½§ç–†', department: 'è‘£äº‹é•·å®¤', position: 'ç‡Ÿé‹ç¸½ç›£', email: 'ea.royalroi@gmail.com', annualLeave: 103, compensatoryLeave: 0, authority: 'ä¸»ç®¡' },
            'A19104': { name: 'é™³å®¶èˆˆ', department: 'ç®¡ç†éƒ¨', position: 'ç®¡ç†éƒ¨å‰¯ç†', email: 'airforce0722@gmail.com', annualLeave: 68, compensatoryLeave: 0.5, authority: 'å“¡å·¥' },
            'A19132': { name: 'é»ƒå´‘å¢ƒ', department: 'ç®¡ç†éƒ¨', position: 'å·¥å‹™ä¸»ä»»', email: 'drogn1129@gmail.com', annualLeave: 61, compensatoryLeave: 0.5, authority: 'å“¡å·¥' },
            'A19147': { name: 'å¾å¿—å±¹', department: 'è¡ŒéŠ·æ¥­å‹™éƒ¨', position: 'è¡ŒéŠ·æ¥­å‹™ä¸»ä»»', email: 'joe70041@gmail.com', annualLeave: 11, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19107': { name: 'æ±Ÿå­Ÿåº­', department: 'å®¢æˆ¿éƒ¨', position: 'å®¢å‹™çµ„é•·', email: 'pig52869@gmail.com', annualLeave: 119.5, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19024': { name: 'è•­ç¶­å®', department: 'å®¢æˆ¿éƒ¨', position: 'å®¢å‹™çµ„é•·', email: 'xwh30819@gmail.com', annualLeave: 130.5, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19114': { name: 'å®‹æ·å®‰', department: 'å®¢æˆ¿éƒ¨', position: 'é£¯åº—ç®¡å®¶', email: 'aquarius00216@gmail.com', annualLeave: 199, compensatoryLeave: 0.5, authority: 'å“¡å·¥' },
            'A19133': { name: 'é™³ç´…ç§€', department: 'å®¢æˆ¿éƒ¨', position: 'é£¯åº—ç®¡å®¶', email: 'hx930310@gmail.com', annualLeave: 62.5, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19145': { name: 'æ—å®¶æ¥™', department: 'å®¢æˆ¿éƒ¨', position: 'é£¯åº—ç®¡å®¶', email: 'brcl67@gmail.com', annualLeave: 78.3, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19149': { name: 'æ¥Šä¸å‹›', department: 'å®¢æˆ¿éƒ¨', position: 'é£¯åº—ç®¡å®¶', email: 'a0977442924@gmail.com', annualLeave: 0, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19152': { name: 'å¾å¥•ç¿”', department: 'å®¢æˆ¿éƒ¨', position: 'é£¯åº—ç®¡å®¶', email: 'ken0976887280@gmail.com', annualLeave: 0, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19140': { name: 'æŸ¯å®—ç”·', department: 'å®¢æˆ¿éƒ¨', position: 'å®¢å‹™çµ„é•·', email: '1306allen@gmail.com', annualLeave: 72, compensatoryLeave: 3.5, authority: 'å“¡å·¥' },
            'A19016': { name: 'æç¶­è', department: 'å®¢æˆ¿éƒ¨', position: 'å®¢æˆ¿éƒ¨å‰¯ç†', email: 'glad09120@gmail.com', annualLeave: 125, compensatoryLeave: 5, authority: 'å“¡å·¥' },
            'A19065': { name: 'è¨±é‚¦èˆˆ', department: 'å®¢æˆ¿éƒ¨', position: 'è³‡æ·±æˆ¿å‹™å“¡', email: 'kandyhsu188@gmail.com', annualLeave: 120, compensatoryLeave: 1, authority: 'å“¡å·¥' },
            'A19146': { name: 'ç‹æ–‡ä¸€', department: 'å®¢æˆ¿éƒ¨', position: 'è³‡æ·±æˆ¿å‹™çµ„é•·', email: 'elmo.jpgo@gmail.com', annualLeave: 47.5, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19118': { name: 'ç¾…ç´¹æ–‡', department: 'å®¢æˆ¿éƒ¨', position: 'è³‡æ·±æˆ¿å‹™å“¡', email: 'shawn820419@gmail.com', annualLeave: 58.5, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19136': { name: 'æ—å¥‡ç·¯', department: 'å®¢æˆ¿éƒ¨', position: 'è³‡æ·±æˆ¿å‹™å“¡', email: 'm1493487210@gmail.com', annualLeave: 56, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19151': { name: 'æŸ³ä½³ç’‹', department: 'å®¢æˆ¿éƒ¨', position: 'è³‡æ·±æˆ¿å‹™å“¡', email: 'andrea.liou71@gmail.com', annualLeave: 0, compensatoryLeave: 0, authority: 'å“¡å·¥' },
            'A19002': { name: 'HR', department: 'ç®¡ç†éƒ¨', position: 'HR', email: 'acct.royalroi@gmail.com', annualLeave: 0, compensatoryLeave: 0, authority: 'ç®¡ç†å“¡' }
        };

        let currentUser = null;
        let currentForm = null;

        // åˆå§‹åŒ–ç³»çµ±
        function initSystem() {
            showAlert('ç³»çµ±å·²è¼‰å…¥å®Œæˆï¼Œè«‹é¸æ“‡ç”¨æˆ¶èº«ä»½é–‹å§‹ä½¿ç”¨', 'info');
            
            // 3ç§’å¾Œéš±è—æç¤º
            setTimeout(() => {
                hideAlert();
            }, 3000);
        }

        // åˆ‡æ›ç”¨æˆ¶
        function switchUser() {
            const selectedUser = document.getElementById('userSelect').value;
            if (!selectedUser) {
                hideUserInfo();
                return;
            }

            currentUser = selectedUser;
            const userData = EMPLOYEES[selectedUser];
            
            // æ›´æ–°ç”¨æˆ¶è³‡è¨Š
            document.getElementById('userName').textContent = userData.name;
            document.getElementById('userId').textContent = selectedUser;
            document.getElementById('userDept').textContent = userData.department;
            document.getElementById('userPosition').textContent = userData.position;
            document.getElementById('userEmail').textContent = userData.email;
            document.getElementById('userAuthority').textContent = userData.authority;
            
            // æ›´æ–°å‡æœŸé¤˜é¡
            document.getElementById('annualLeave').textContent = userData.annualLeave;
            document.getElementById('compensatoryLeave').textContent = userData.compensatoryLeave;
            document.getElementById('totalLeave').textContent = userData.annualLeave + userData.compensatoryLeave;
            
            showUserInfo();
            populateDeputyOptions();
        }

        // å¡«å……è·å‹™ä»£ç†äººé¸é …
        function populateDeputyOptions() {
            const deputySelects = document.querySelectorAll('select[name="deputy"]');
            
            deputySelects.forEach(select => {
                select.innerHTML = '<option value="">è«‹é¸æ“‡...</option>';
                
                Object.entries(EMPLOYEES).forEach(([id, employee]) => {
                    if (id !== currentUser) {
                        const option = document.createElement('option');
                        option.value = employee.name;
                        option.textContent = `${employee.name} (${employee.position})`;
                        select.appendChild(option);
                    }
                });
            });
        }

        // é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š
        function showUserInfo() {
            document.getElementById('userInfo').classList.add('active');
        }

        // éš±è—ç”¨æˆ¶è³‡è¨Š
        function hideUserInfo() {
            document.getElementById('userInfo').classList.remove('active');
        }

        // é¡¯ç¤ºè¡¨å–®
        function showForm(formType) {
            if (!currentUser) {
                showAlert('è«‹å…ˆé¸æ“‡ç”¨æˆ¶èº«ä»½', 'error');
                return;
            }

            // éš±è—æ‰€æœ‰è¡¨å–®å’Œç®¡ç†é¢æ¿
            hideForm();
            hideAdminPanel();

            // é¡¯ç¤ºæŒ‡å®šè¡¨å–®
            const formElement = document.getElementById(formType + 'Form');
            if (formElement) {
                formElement.classList.add('active');
                currentForm = formType;
                
                // å¡«å…¥ç”¨æˆ¶è³‡è¨Š
                fillUserInfo(formType);
                
                // ç‰¹æ®Šè™•ç†ç‰¹ä¼‘è£œä¼‘è¡¨å–®
                if (formType === 'vacation') {
                    updateAvailableHours();
                }
                
                // æ»¾å‹•åˆ°è¡¨å–®ä½ç½®
                formElement.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        // éš±è—è¡¨å–®
        function hideForm() {
            const forms = document.querySelectorAll('.form-container');
            forms.forEach(form => {
                form.classList.remove('active');
            });
            currentForm = null;
        }

        // å¡«å…¥ç”¨æˆ¶è³‡è¨Š
        function fillUserInfo(formType) {
            const userData = EMPLOYEES[currentUser];
            const prefix = formType + '_';
            
            // å¡«å…¥ç”³è«‹äººè³‡è¨Š
            const nameField = document.getElementById(prefix + 'applicantName');
            const idField = document.getElementById(prefix + 'applicantId');
            const deptField = document.getElementById(prefix + 'applicantDept');
            const positionField = document.getElementById(prefix + 'applicantPosition');
            
            if (nameField) nameField.value = userData.name;
            if (idField) idField.value = currentUser;
            if (deptField) deptField.value = userData.department;
            if (positionField) positionField.value = userData.position;
        }

        // æ›´æ–°å¯ç”¨æ™‚æ•¸
        function updateAvailableHours() {
            const vacationType = document.getElementById('vacation_type').value;
            const userData = EMPLOYEES[currentUser];
            
            if (!vacationType || !userData) return;
            
            let availableHours = 0;
            if (vacationType === 'ç‰¹ä¼‘') {
                availableHours = userData.annualLeave;
            } else if (vacationType === 'è£œä¼‘') {
                availableHours = userData.compensatoryLeave;
            }
            
            document.getElementById('vacation_availableHours').value = availableHours + ' å°æ™‚';
            calculateRequestedHours();
        }

        // è¨ˆç®—ç”³è«‹æ™‚æ•¸
        function calculateRequestedHours() {
            const startDateTime = document.getElementById('vacation_startDateTime').value;
            const endDateTime = document.getElementById('vacation_endDateTime').value;
            const vacationType = document.getElementById('vacation_type').value;
            
            if (!startDateTime || !endDateTime || !vacationType) return;
            
            const start = new Date(startDateTime);
            const end = new Date(endDateTime);
            
            if (end <= start) {
                showHoursError('çµæŸæ™‚é–“å¿…é ˆæ™šæ–¼é–‹å§‹æ™‚é–“');
                return;
            }
            
            // è¨ˆç®—æ™‚æ•¸å·®ç•°
            const diffMs = end - start;
            const diffHours = diffMs / (1000 * 60 * 60);
            
            document.getElementById('vacation_requestedHours').value = diffHours;
            
            // æª¢æŸ¥æ˜¯å¦è¶…éå¯ç”¨æ™‚æ•¸
            const userData = EMPLOYEES[currentUser];
            let availableHours = 0;
            if (vacationType === 'ç‰¹ä¼‘') {
                availableHours = userData.annualLeave;
            } else if (vacationType === 'è£œä¼‘') {
                availableHours = userData.compensatoryLeave;
            }
            
            const remainingHours = availableHours - diffHours;
            document.getElementById('vacation_remainingHours').value = remainingHours + ' å°æ™‚';
            
            // é¡¯ç¤ºè­¦å‘Šæˆ–éŒ¯èª¤
            if (remainingHours < 0) {
                showHoursError(`ç”³è«‹æ™‚æ•¸ ${diffHours} å°æ™‚è¶…éå¯ç”¨æ™‚æ•¸ ${availableHours} å°æ™‚ï¼Œç„¡æ³•æäº¤ç”³è«‹`);
                document.getElementById('vacation_submitBtn').disabled = true;
            } else if (remainingHours < 8) {
                showHoursWarning(`ç”³è«‹å¾Œå‰©é¤˜æ™‚æ•¸è¼ƒå°‘ (${remainingHours} å°æ™‚)ï¼Œè«‹ç¢ºèªæ˜¯å¦ç¹¼çºŒ`);
                document.getElementById('vacation_submitBtn').disabled = false;
            } else {
                hideHoursMessages();
                document.getElementById('vacation_submitBtn').disabled = false;
            }
        }

        // é¡¯ç¤ºæ™‚æ•¸è­¦å‘Š
        function showHoursWarning(message) {
            hideHoursMessages();
            const warningDiv = document.getElementById('vacation_hoursWarning');
            warningDiv.textContent = message;
            warningDiv.style.display = 'block';
        }

        // é¡¯ç¤ºæ™‚æ•¸éŒ¯èª¤
        function showHoursError(message) {
            hideHoursMessages();
            const errorDiv = document.getElementById('vacation_hoursError');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        // éš±è—æ™‚æ•¸è¨Šæ¯
        function hideHoursMessages() {
            document.getElementById('vacation_hoursWarning').style.display = 'none';
            document.getElementById('vacation_hoursError').style.display = 'none';
        }

        // é¡¯ç¤ºç®¡ç†å¾Œå°
        function showAdminPanel() {
            hideForm();
            document.getElementById('adminPanel').classList.add('active');
            loadAdminData();
        }

        // éš±è—ç®¡ç†å¾Œå°
        function hideAdminPanel() {
            document.getElementById('adminPanel').classList.remove('active');
        }

        // è¼‰å…¥ç®¡ç†è³‡æ–™
        function loadAdminData() {
            // é€™è£¡æœƒå¾å¾Œç«¯è¼‰å…¥æ‰€æœ‰ç”³è«‹è³‡æ–™
            // æš«æ™‚é¡¯ç¤ºç¤ºä¾‹è³‡æ–™
            const tbody = document.getElementById('admin_dataBody');
            tbody.innerHTML = `
                <tr>
                    <td>VAC20250923001</td>
                    <td>ç‰¹ä¼‘è£œä¼‘ç”³è«‹</td>
                    <td>é™³å®¶èˆˆ</td>
                    <td>2025-09-23 10:30</td>
                    <td><span class="status-badge status-pending">å¾…å¯©æ ¸</span></td>
                    <td>
                        <button onclick="approveApplication('VAC20250923001')" style="background: #28a745; color: white; border: none; padding: 5px 10px; border-radius: 3px; margin-right: 5px; cursor: pointer;">æ ¸å‡†</button>
                        <button onclick="rejectApplication('VAC20250923001')" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">æ‹’çµ•</button>
                    </td>
                </tr>
            `;
        }

        // è™•ç†è¡¨å–®æäº¤
        function handleFormSubmit(event, formType) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const data = {};
            
            // æ”¶é›†è¡¨å–®è³‡æ–™
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // æ·»åŠ ç”³è«‹é¡å‹å’Œç”¨æˆ¶è³‡è¨Š
            data.applicationType = formType;
            data.submittedAt = new Date().toISOString();
            data.submittedBy = EMPLOYEES[currentUser].name;
            data.submittedById = currentUser;
            
            // æäº¤åˆ°å¾Œç«¯
            submitApplication(data);
        }

        // æäº¤ç”³è«‹åˆ°å¾Œç«¯
        async function submitApplication(data) {
            showAlert('æ­£åœ¨æäº¤ç”³è«‹...', 'info');
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        action: 'submitApplication',
                        ...data
                    })
                });
                
                if (!response.ok) {
                    throw new Error('ç¶²è·¯è«‹æ±‚å¤±æ•— (HTTP ' + response.status + ')');
                }
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert('ç”³è«‹æäº¤æˆåŠŸï¼ç”³è«‹ç·¨è™Ÿï¼š' + (result.data?.applicationId || 'ç³»çµ±ç”Ÿæˆä¸­'), 'success');
                    hideForm();
                    
                    // é‡ç½®è¡¨å–®
                    if (currentForm) {
                        document.getElementById(currentForm + 'ApplicationForm').reset();
                        fillUserInfo(currentForm);
                    }
                } else {
                    showAlert('ç”³è«‹æäº¤å¤±æ•—ï¼š' + result.message, 'error');
                }
                
            } catch (error) {
                console.error('æäº¤éŒ¯èª¤:', error);
                showAlert('æäº¤å¤±æ•—ï¼š' + error.message + 'ã€‚è«‹æª¢æŸ¥ç¶²è·¯é€£æ¥æˆ–è¯ç¹«ç³»çµ±ç®¡ç†å“¡ã€‚', 'error');
            }
        }

        // é¡¯ç¤ºç³»çµ±æç¤º
        function showAlert(message, type = 'info') {
            const alert = document.getElementById('systemAlert');
            alert.textContent = message;
            alert.className = `alert ${type} show`;
            
            // 5ç§’å¾Œè‡ªå‹•éš±è—
            setTimeout(() => {
                hideAlert();
            }, 5000);
        }

        // éš±è—ç³»çµ±æç¤º
        function hideAlert() {
            const alert = document.getElementById('systemAlert');
            alert.classList.remove('show');
        }

        // ç®¡ç†åŠŸèƒ½
        function filterApplications() {
            showAlert('ç¯©é¸åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
        }

        function exportData() {
            showAlert('åŒ¯å‡ºåŠŸèƒ½é–‹ç™¼ä¸­', 'info');
        }

        function printData() {
            window.print();
        }

        function refreshData() {
            loadAdminData();
            showAlert('è³‡æ–™å·²é‡æ–°æ•´ç†', 'success');
        }

        function approveApplication(id) {
            showAlert(`ç”³è«‹ ${id} å·²æ ¸å‡†`, 'success');
        }

        function rejectApplication(id) {
            showAlert(`ç”³è«‹ ${id} å·²æ‹’çµ•`, 'warning');
        }

        // ç¶å®šè¡¨å–®æäº¤äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            // ç‰¹ä¼‘è£œä¼‘ç”³è«‹è¡¨å–®
            document.getElementById('vacationApplicationForm').addEventListener('submit', function(e) {
                handleFormSubmit(e, 'vacation');
            });
            
            // åˆå§‹åŒ–ç³»çµ±
            initSystem();
        });
    </script>
</body>
</html>
